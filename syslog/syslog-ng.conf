#############################################################################
# Default syslog-ng.conf file which collects all local logs into a
# single file called /var/log/messages tailored to container usage.
#
# The changes from the stock, default syslog-ng.conf file is that we've
# dropped the system() source that is not needed and that we enabled network
# connections using default-network-drivers(). Customize as needed and
# override using the -v option to docker, such as:
#
#  docker run ...  -v "$PWD/syslog-ng.conf":/etc/syslog-ng/syslog-ng.conf
#

@version: 4.4
@include "scl.conf"

options { flush_lines(0); perm(0640); threaded(yes); owner("root"); group("adm");
	perm(0640); create_dirs(yes); dir_perm(0750);
};


#source s_local {
##        system();
#	internal();
#};

#source s_network {
#        default-network-drivers(
                # NOTE: TLS support
                #
                # the default-network-drivers() source driver opens the TLS
                # enabled ports as well, however without an actual key/cert
                # pair they will not operate and syslog-ng would display a
                # warning at startup.
                #
                #tls(key-file("/path/to/ssl-private-key") cert-file("/path/to/ssl-cert"))
#        );
#};

#destination d_local {
#        file("/var/log/messages");
#        file("/var/log/messages-kv.log" template("$ISODATE $HOST $(format-welf --scope all-nv-pairs)\n") frac-digits(3));
#};

#log {
#        source(s_local);
        #source(s_network);
#        destination(d_local);
#};

##########################

source s_nginx1 {
    system();
    internal();

    udp(ip("0.0.0.0") port(514));
    tcp(ip("0.0.0.0") port(514));

};

destination d_nginx1 {
    file("/var/log/nginx1.log");
};

log {
    source(s_nginx1);
    destination(d_nginx1);
};
